#!/bin/bash
set -e

echo "ğŸ” Running gofmt..."
fmt_result=$(gofmt -l .)
if [ -n "$fmt_result" ]; then
    echo "âŒ gofmt found unformatted files:"
    echo "$fmt_result"
    exit 1
fi

echo "ğŸ” Running go vet..."
go vet ./...

echo "ğŸ“„ Regenerating README.md..."
go run scripts/generate_readme/generate_readme.go

if [ $? -ne 0 ]; then
    echo "âŒ Failed to generate README.md"
    exit 1
fi

echo "âœ… Adding updated README.md to commit"
git add README.md
